@page "/EthereumExplorer"
@using Microsoft.Extensions.Configuration
@using Savitar.Domain.Dtos
@using Savitar.Domain.Models
@inject HttpClient Http

<BasePage Title="Ethereum Playground" OnInitData="OnInitData">
    <MudCard Outlined="true">
        <MudCardHeader class="pl-5 py-1" style="background-color: var(--mud-palette-background-grey)">
            <CardHeaderContent>
                <MudText Typo="Typo.h6">ETHERIUM BLOCKCHAIN INFO</MudText>
            </CardHeaderContent>
        </MudCardHeader>
        <MudCardContent>
            <MudText><b>Latest Block Number:</b> @_data.LatestBlockNumber</MudText>            
            <MudText><b>Etherium Foundation Balance:</b> @string.Format($"${_data.Balance:###,###,###,##0.00}")</MudText>
            <MudText><b>Network Version:</b> @_data.NetworkVersion</MudText>
        </MudCardContent>
    </MudCard>

    @code {        
        EthInfo _data;

        async Task OnInitData(BasePageServices basePageServices)
        {
            try
            {
                basePageServices.DisplayMessage("Fetching top level ETH blockchain info");
                _data  = await Http.GetFromJsonAsync<EthInfo>("api/EthFunctions/getall");
            }
            catch (Exception ex)
            {            
                Console.WriteLine(ex.Message);
            }

            @*hasLoaded = true; *@
        }        
    }
</BasePage>